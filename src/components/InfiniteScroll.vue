<template>
    <div class="w-full">
        <slot/>
        <div v-show="load_more" class="w-full">
            <div 
                class="flex justify-center mt-3"
                id="load-more" 
            >
                <svg class="animate-spin text-[42px]" width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22.75 1.75V5.25C22.75 5.71413 22.5656 6.15925 22.2374 6.48744C21.9092 6.81563 21.4641 7 21 7C20.5359 7 20.0908 6.81563 19.7626 6.48744C19.4344 6.15925 19.25 5.71413 19.25 5.25V1.75C19.25 1.28587 19.4344 0.840752 19.7626 0.512563C20.0908 0.184374 20.5359 0 21 0C21.4641 0 21.9092 0.184374 22.2374 0.512563C22.5656 0.840752 22.75 1.28587 22.75 1.75ZM21 35C20.5359 35 20.0908 35.1844 19.7626 35.5126C19.4344 35.8408 19.25 36.2859 19.25 36.75V40.25C19.25 40.7141 19.4344 41.1592 19.7626 41.4874C20.0908 41.8156 20.5359 42 21 42C21.4641 42 21.9092 41.8156 22.2374 41.4874C22.5656 41.1592 22.75 40.7141 22.75 40.25V36.75C22.75 36.2859 22.5656 35.8408 22.2374 35.5126C21.9092 35.1844 21.4641 35 21 35ZM7 21C7 20.5359 6.81563 20.0908 6.48744 19.7626C6.15925 19.4344 5.71413 19.25 5.25 19.25H1.75C1.28587 19.25 0.840752 19.4344 0.512563 19.7626C0.184374 20.0908 0 20.5359 0 21C0 21.4641 0.184374 21.9092 0.512563 22.2374C0.840752 22.5656 1.28587 22.75 1.75 22.75H5.25C5.71413 22.75 6.15925 22.5656 6.48744 22.2374C6.81563 21.9092 7 21.4641 7 21ZM40.25 19.25H36.75C36.2859 19.25 35.8408 19.4344 35.5126 19.7626C35.1844 20.0908 35 20.5359 35 21C35 21.4641 35.1844 21.9092 35.5126 22.2374C35.8408 22.5656 36.2859 22.75 36.75 22.75H40.25C40.7141 22.75 41.1592 22.5656 41.4874 22.2374C41.8156 21.9092 42 21.4641 42 21C42 20.5359 41.8156 20.0908 41.4874 19.7626C41.1592 19.4344 40.7141 19.25 40.25 19.25ZM31.5315 2.8315C31.3326 2.71618 31.113 2.64118 30.8851 2.61078C30.6572 2.58038 30.4255 2.59519 30.2034 2.65434C29.9812 2.7135 29.7729 2.81585 29.5903 2.95554C29.4077 3.09524 29.2545 3.26955 29.1392 3.4685L27.3892 6.49775C27.1571 6.89948 27.0939 7.37697 27.2137 7.82525C27.3335 8.27353 27.6264 8.65589 28.028 8.88825C28.2934 9.04348 28.5955 9.12504 28.903 9.1245C29.2102 9.12449 29.512 9.04363 29.778 8.89003C30.044 8.73644 30.2649 8.51553 30.4185 8.2495L32.1685 5.22025C32.4003 4.81889 32.4634 4.34198 32.344 3.89415C32.2246 3.44632 31.9324 3.06415 31.5315 2.8315ZM13.9773 33.1117C13.5757 32.8794 13.0984 32.816 12.6501 32.9354C12.2019 33.0549 11.8194 33.3474 11.5868 33.7487L9.83675 36.778C9.6044 37.1795 9.54099 37.6569 9.66043 38.1051C9.77988 38.5534 10.0724 38.9358 10.4738 39.1685C10.7393 39.3236 11.0413 39.4051 11.3488 39.4048C11.6562 39.4051 11.9584 39.3243 12.2247 39.1707C12.4911 39.0171 12.7123 38.796 12.866 38.5298L14.616 35.5005C14.8476 35.0989 14.9105 34.6219 14.7907 34.174C14.671 33.7261 14.3784 33.3441 13.9773 33.1117ZM8.25125 11.5868L5.222 9.83675C4.82134 9.62114 4.35246 9.57005 3.91477 9.69431C3.47708 9.81857 3.10499 10.1084 2.87739 10.5024C2.64979 10.8964 2.58458 11.3635 2.69558 11.8047C2.80659 12.246 3.08507 12.6266 3.472 12.866L6.50125 14.616C6.90191 14.8316 7.37079 14.8827 7.80848 14.7584C8.24617 14.6342 8.61826 14.3443 8.84586 13.9504C9.07346 13.5564 9.13867 13.0893 9.02767 12.648C8.91666 12.2068 8.63818 11.8261 8.25125 11.5868ZM38.5262 29.1392L35.497 27.3892C35.0963 27.1736 34.6275 27.1225 34.1898 27.2468C33.7521 27.3711 33.38 27.6609 33.1524 28.0549C32.9248 28.4489 32.8596 28.916 32.9706 29.3572C33.0816 29.7985 33.3601 30.1791 33.747 30.4185L36.7762 32.1685C37.0417 32.3237 37.3438 32.4053 37.6512 32.4048C38.0365 32.4047 38.4109 32.2776 38.7165 32.0431C39.0221 31.8086 39.2418 31.4798 39.3415 31.1077C39.4412 30.7356 39.4154 30.341 39.268 29.9851C39.1206 29.6292 38.8599 29.3319 38.5262 29.1392ZM12.8608 3.4685C12.6214 3.08157 12.2407 2.80309 11.7995 2.69208C11.3582 2.58108 10.8911 2.64629 10.4971 2.87389C10.1032 3.10149 9.81332 3.47358 9.68906 3.91127C9.5648 4.34896 9.61589 4.81784 9.8315 5.2185L11.5815 8.24775C11.7351 8.51378 11.956 8.73469 12.222 8.88828C12.4881 9.04188 12.7898 9.12274 13.097 9.12275C13.4045 9.12329 13.7066 9.04173 13.972 8.8865C14.3736 8.65414 14.6665 8.27178 14.7863 7.8235C14.9061 7.37522 14.8429 6.89773 14.6108 6.496L12.8608 3.4685ZM30.4132 33.7435C30.1739 33.3566 29.7932 33.0781 29.352 32.9671C28.9107 32.8561 28.4436 32.9213 28.0496 33.1489C27.6557 33.3765 27.3658 33.7486 27.2416 34.1863C27.1173 34.624 27.1684 35.0928 27.384 35.4935L29.134 38.5228C29.3734 38.9097 29.754 39.1882 30.1953 39.2992C30.6365 39.4102 31.1036 39.345 31.4976 39.1174C31.8916 38.8898 32.1814 38.5177 32.3057 38.08C32.43 37.6423 32.3789 37.1734 32.1632 36.7728L30.4132 33.7435ZM34.6273 14.8435C34.9344 14.8435 35.2362 14.7626 35.5023 14.609L38.5315 12.859C38.9184 12.6196 39.1969 12.239 39.3079 11.7977C39.4189 11.3565 39.3537 10.8894 39.1261 10.4954C38.8985 10.1014 38.5264 9.81157 38.0887 9.68731C37.651 9.56305 37.1822 9.61414 36.7815 9.82975L33.7523 11.5798C33.4195 11.7728 33.1596 12.07 33.0128 12.4256C32.866 12.7811 32.8404 13.1751 32.94 13.5467C33.0396 13.9182 33.2589 14.2466 33.5639 14.481C33.8689 14.7154 34.2426 14.8428 34.6273 14.8435ZM6.49775 27.384L3.4685 29.134C3.1349 29.3266 2.87418 29.6239 2.72677 29.9798C2.57936 30.3358 2.5535 30.7303 2.65321 31.1024C2.75291 31.4745 2.9726 31.8033 3.27822 32.0378C3.58383 32.2724 3.95828 32.3995 4.3435 32.3995C4.651 32.4 4.95306 32.3185 5.2185 32.1632L8.24775 30.4132C8.63468 30.1739 8.91316 29.7932 9.02417 29.352C9.13517 28.9107 9.06996 28.4436 8.84236 28.0496C8.61476 27.6557 8.24267 27.3658 7.80498 27.2416C7.36729 27.1173 6.89841 27.1684 6.49775 27.384Z" fill="#1155CC"></path>
                </svg>
            </div>
        </div>
    </div>
</template>

<script>
import { defineComponent } from 'vue';

export default defineComponent({
    name: 'InfiniteScroll',
    props: {
        load_more: Boolean
    },
    mounted() {
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        this.$emit('bottom_reached');
                    }
                })
            }, 
            { rootMargin: '-50% 0px 0px 0px' }
        )
        let load_more = document.querySelector('#load-more');
        if (load_more) {
            observer.observe(load_more);
        }
    }
})
</script>
